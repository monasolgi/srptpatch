/home/solgi/srptpatch/run_models.py
2025-08-24 13:55:22
run_models.py --dataset activity --state def --history 24 --patience 10 --batch_size 32 --lr 1e-3 --patch_size 8 --stride 4 --nhead 1 --tf_layer 1 --nlayer 1 --te_dim 10 --node_dim 10 --hid_dim 64 --outlayer Linear --gpu 1
Namespace(state='def', n=100000000, hop=1, nhead=1, tf_layer=1, nlayer=1, epoch=1000, patience=10, history=24, patch_size=8.0, stride=4.0, logmode='a', lr=0.001, w_decay=0.0, batch_size=32, save='experiments/', load=None, seed=1, dataset='activity', quantization=0.0, model='tPatchGNN', outlayer='Linear', hid_dim=64, te_dim=10, node_dim=10, gpu='1', npatch=5, device=device(type='cpu'), PID=428564, pred_window=1000, ndim=12)
- Epoch 000, ExpID 43751
Train - Loss (one batch): 0.01459
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01558, 0.01558, 0.12483, 0.09626, 24.67%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 0, 0.01561, 0.01561, 0.12493, 0.09711, 22.20%
Time spent: 18.01s
- Epoch 001, ExpID 43751
Train - Loss (one batch): 0.02517
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01599, 0.01599, 0.12644, 0.09700, 23.82%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 0, 0.01561, 0.01561, 0.12493, 0.09711, 22.20%
Time spent: 16.13s
- Epoch 002, ExpID 43751
Train - Loss (one batch): 0.00960
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01566, 0.01566, 0.12514, 0.09567, 25.56%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 0, 0.01561, 0.01561, 0.12493, 0.09711, 22.20%
Time spent: 16.17s
- Epoch 003, ExpID 43751
Train - Loss (one batch): 0.02647
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01537, 0.01537, 0.12396, 0.09442, 24.62%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 3, 0.01490, 0.01490, 0.12208, 0.09361, 21.66%
Time spent: 17.70s
- Epoch 004, ExpID 43751
Train - Loss (one batch): 0.02175
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01449, 0.01449, 0.12039, 0.09036, 23.70%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 4, 0.01397, 0.01397, 0.11821, 0.08933, 20.68%
Time spent: 17.75s
- Epoch 005, ExpID 43751
Train - Loss (one batch): 0.01339
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01679, 0.01679, 0.12959, 0.09903, 27.72%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 4, 0.01397, 0.01397, 0.11821, 0.08933, 20.68%
Time spent: 16.08s
- Epoch 006, ExpID 43751
Train - Loss (one batch): 0.01282
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01743, 0.01743, 0.13204, 0.10334, 28.63%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 4, 0.01397, 0.01397, 0.11821, 0.08933, 20.68%
Time spent: 16.20s
- Epoch 007, ExpID 43751
Train - Loss (one batch): 0.01461
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01445, 0.01445, 0.12023, 0.09061, 24.73%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 7, 0.01346, 0.01346, 0.11601, 0.08766, 21.27%
Time spent: 18.14s
- Epoch 008, ExpID 43751
Train - Loss (one batch): 0.01321
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01377, 0.01377, 0.11734, 0.08709, 23.17%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 8, 0.01304, 0.01304, 0.11419, 0.08536, 20.06%
Time spent: 17.82s
- Epoch 009, ExpID 43751
Train - Loss (one batch): 0.01271
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01371, 0.01371, 0.11710, 0.08773, 22.37%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 9, 0.01344, 0.01344, 0.11594, 0.08771, 19.73%
Time spent: 17.79s
- Epoch 010, ExpID 43751
Train - Loss (one batch): 0.00716
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01551, 0.01551, 0.12456, 0.09524, 26.27%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 9, 0.01344, 0.01344, 0.11594, 0.08771, 19.73%
Time spent: 16.20s
- Epoch 011, ExpID 43751
Train - Loss (one batch): 0.00895
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01413, 0.01413, 0.11887, 0.08922, 23.89%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 9, 0.01344, 0.01344, 0.11594, 0.08771, 19.73%
Time spent: 16.23s
- Epoch 012, ExpID 43751
Train - Loss (one batch): 0.01190
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01328, 0.01328, 0.11523, 0.08583, 22.18%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 12, 0.01288, 0.01288, 0.11349, 0.08527, 19.43%
Time spent: 17.69s
- Epoch 013, ExpID 43751
Train - Loss (one batch): 0.01162
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01577, 0.01577, 0.12559, 0.09576, 26.52%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 12, 0.01288, 0.01288, 0.11349, 0.08527, 19.43%
Time spent: 16.26s
- Epoch 014, ExpID 43751
Train - Loss (one batch): 0.01704
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01470, 0.01470, 0.12125, 0.09162, 25.25%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 12, 0.01288, 0.01288, 0.11349, 0.08527, 19.43%
Time spent: 16.20s
- Epoch 015, ExpID 43751
Train - Loss (one batch): 0.02034
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01386, 0.01386, 0.11775, 0.08778, 24.46%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 12, 0.01288, 0.01288, 0.11349, 0.08527, 19.43%
Time spent: 16.20s
- Epoch 016, ExpID 43751
Train - Loss (one batch): 0.01231
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01223, 0.01223, 0.11060, 0.08210, 21.85%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 16, 0.01154, 0.01154, 0.10741, 0.08050, 18.81%
Time spent: 17.72s
- Epoch 017, ExpID 43751
Train - Loss (one batch): 0.00923
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01319, 0.01319, 0.11485, 0.08622, 23.77%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 16, 0.01154, 0.01154, 0.10741, 0.08050, 18.81%
Time spent: 16.24s
- Epoch 018, ExpID 43751
Train - Loss (one batch): 0.01823
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01168, 0.01168, 0.10805, 0.07971, 21.46%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 18, 0.01104, 0.01104, 0.10507, 0.07838, 18.51%
Time spent: 17.78s
- Epoch 019, ExpID 43751
Train - Loss (one batch): 0.00907
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01135, 0.01135, 0.10654, 0.07804, 20.73%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 19, 0.01070, 0.01070, 0.10344, 0.07636, 17.70%
Time spent: 17.78s
- Epoch 020, ExpID 43751
Train - Loss (one batch): 0.01036
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01126, 0.01126, 0.10611, 0.07763, 20.87%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 20, 0.01052, 0.01052, 0.10256, 0.07569, 17.80%
Time spent: 17.78s
- Epoch 021, ExpID 43751
Train - Loss (one batch): 0.02109
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01130, 0.01130, 0.10631, 0.07800, 20.22%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 20, 0.01052, 0.01052, 0.10256, 0.07569, 17.80%
Time spent: 16.30s
- Epoch 022, ExpID 43751
Train - Loss (one batch): 0.01943
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01157, 0.01157, 0.10754, 0.07818, 21.56%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 20, 0.01052, 0.01052, 0.10256, 0.07569, 17.80%
Time spent: 16.26s
- Epoch 023, ExpID 43751
Train - Loss (one batch): 0.00444
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01086, 0.01086, 0.10421, 0.07567, 19.99%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 23, 0.01031, 0.01031, 0.10156, 0.07419, 17.06%
Time spent: 17.79s
- Epoch 024, ExpID 43751
Train - Loss (one batch): 0.01544
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01120, 0.01120, 0.10582, 0.07795, 20.03%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 23, 0.01031, 0.01031, 0.10156, 0.07419, 17.06%
Time spent: 16.19s
- Epoch 025, ExpID 43751
Train - Loss (one batch): 0.01124
Val - Loss, MSE, RMSE, MAE, MAPE: 0.01084, 0.01084, 0.10412, 0.07625, 19.40%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 25, 0.01050, 0.01050, 0.10249, 0.07563, 16.94%
Time spent: 17.72s
Traceback (most recent call last):
  File "/home/solgi/srptpatch/run_models.py", line 131, in <module>
    train_res = compute_all_losses(model, batch_dict)
  File "/home/solgi/srptpatch/lib/evaluation.py", line 312, in compute_all_losses
    pred_y = model.forecasting(batch_dict["tp_to_predict"], 
  File "/home/solgi/srptpatch/tPatchGNN/model/tPatchGNN.py", line 272, in forecasting
    X = X.permute(0, 3, 1, 2).reshape(-1, L_in, 1) # (B*N*M, L, 1)
RuntimeError: cannot reshape tensor of 0 elements into shape [-1, 0, 1] because the unspecified dimension size -1 can be any value and is ambiguous
